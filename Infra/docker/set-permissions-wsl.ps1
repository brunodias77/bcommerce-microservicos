# B-Commerce - Script para definir permiss√µes execut√°veis nos scripts WSL
# Autor: B-Commerce Team
# Data: $(Get-Date -Format "yyyy-MM-dd")
# Para ser executado no PowerShell do Windows antes de usar os scripts no WSL

Write-Host "üîß Configurando permiss√µes para scripts WSL..." -ForegroundColor Green
Write-Host "=============================================" -ForegroundColor Green

# Verificar se estamos no diret√≥rio correto
if (-not (Test-Path "docker-compose.yml")) {
    Write-Host "‚ùå Erro: docker-compose.yml n√£o encontrado no diret√≥rio atual." -ForegroundColor Red
    Write-Host "   Execute este script a partir da raiz do projeto." -ForegroundColor Yellow
    Write-Host "   Diret√≥rio atual: $(Get-Location)" -ForegroundColor Yellow
    exit 1
}

# Lista dos scripts WSL
$wslScripts = @(
    "Infra\docker\start-wsl.sh",
    "Infra\docker\stop-wsl.sh", 
    "Infra\docker\status-wsl.sh",
    "Infra\docker\cleanup-wsl.sh"
)

Write-Host ""
Write-Host "üìã Scripts WSL encontrados:" -ForegroundColor Cyan

foreach ($script in $wslScripts) {
    if (Test-Path $script) {
        Write-Host "‚úÖ $script" -ForegroundColor Green
        
        # Definir atributos do arquivo para garantir compatibilidade com WSL
        $file = Get-Item $script
        $file.Attributes = $file.Attributes -band (-bnot [System.IO.FileAttributes]::ReadOnly)
        
        Write-Host "   ‚Üí Atributos configurados para WSL" -ForegroundColor Gray
    } else {
        Write-Host "‚ùå $script - N√£o encontrado" -ForegroundColor Red
    }
}

Write-Host ""
Write-Host "üêß Instru√ß√µes para WSL:" -ForegroundColor Yellow
Write-Host "======================" -ForegroundColor Yellow
Write-Host "Para definir as permiss√µes execut√°veis no WSL, execute os seguintes comandos:" -ForegroundColor White
Write-Host ""
Write-Host "1. Abra o WSL (Ubuntu, Debian, etc.)" -ForegroundColor Cyan
Write-Host "2. Navegue at√© o diret√≥rio do projeto:" -ForegroundColor Cyan
Write-Host "   cd /mnt/c/Users/Bruno\ Dias/Documents/programacao/codigos/dotnet/bcommerce-microservicos" -ForegroundColor Gray
Write-Host ""
Write-Host "3. Execute os comandos de permiss√£o:" -ForegroundColor Cyan
Write-Host "   chmod +x ./Infra/docker/start-wsl.sh" -ForegroundColor Gray
Write-Host "   chmod +x ./Infra/docker/stop-wsl.sh" -ForegroundColor Gray  
Write-Host "   chmod +x ./Infra/docker/status-wsl.sh" -ForegroundColor Gray
Write-Host "   chmod +x ./Infra/docker/cleanup-wsl.sh" -ForegroundColor Gray
Write-Host ""
Write-Host "4. Ou execute todos de uma vez:" -ForegroundColor Cyan
Write-Host "   chmod +x ./Infra/docker/*-wsl.sh" -ForegroundColor Gray
Write-Host ""
Write-Host "‚úÖ Configura√ß√£o conclu√≠da no Windows!" -ForegroundColor Green
Write-Host "   Agora execute os comandos chmod no WSL para finalizar." -ForegroundColor Yellow

Write-Host ""
Write-Host "üí° Comandos √∫teis ap√≥s configurar as permiss√µes:" -ForegroundColor Magenta
Write-Host "üöÄ Iniciar infraestrutura: ./Infra/docker/start-wsl.sh" -ForegroundColor White
Write-Host "üìä Verificar status: ./Infra/docker/status-wsl.sh" -ForegroundColor White
Write-Host "üõë Parar servi√ßos: ./Infra/docker/stop-wsl.sh" -ForegroundColor White
Write-Host "üßπ Limpeza completa: ./Infra/docker/cleanup-wsl.sh" -ForegroundColor White